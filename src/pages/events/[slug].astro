---
import Layout from '../../layouts/Layout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const events = await getCollection('events');
  return events.map(event => ({
    params: { slug: event.id },
    props: { event },
  }));
}

const { event } = Astro.props;
const { Content } = await render(event);

const formattedDate = new Date(event.data.date).toLocaleDateString('en-GB', {
  weekday: 'long',
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

const typeColors = {
  concert: 'text-heritage-currant border-heritage-currant/20 bg-heritage-currant-soft',
  rehearsal: 'text-sage-ash border-sage-ash/20 bg-sage-ash-soft',
  'play day': 'text-mist-blue-dark border-mist-blue/20 bg-mist-blue-soft',
  other: 'text-graphite border-graphite/20 bg-graphite-soft',
};
---

<Layout title={event.data.name} description={event.data.description}>
  <div class="prose-container">
    <a href="/events" class="inline-flex items-center text-[11px] font-bold text-graphite/40 hover:text-heritage-currant mb-12 transition-colors uppercase tracking-[0.2em]">
      <svg class="mr-2 h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
      </svg>
      Return to events
    </a>

    <header class="mb-16">
      <div class="flex items-center space-x-2 mb-8">
        <span class={`inline-flex items-center px-3 py-1 text-[10px] font-bold uppercase tracking-[0.2em] border ${typeColors[event.data.type] || typeColors.other}`}>
          {event.data.type}
        </span>
      </div>
      <h1 class="mb-12">{event.data.name}</h1>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-12 bg-graphite-soft/30 p-12 rounded-sm border border-graphite/5">
        <div>
          <h2 class="text-[10px] font-bold text-sage-ash uppercase tracking-[0.2em] mb-4 mt-0">Date</h2>
          <p class="text-lg text-graphite font-serif">{formattedDate}</p>
        </div>
        <div>
          <h2 class="text-[10px] font-bold text-sage-ash uppercase tracking-[0.2em] mb-4 mt-0">Time</h2>
          <p class="text-lg text-graphite font-serif">{event.data.time}</p>
        </div>
        <div class="sm:col-span-2">
          <h2 class="text-[10px] font-bold text-sage-ash uppercase tracking-[0.2em] mb-4 mt-0">Location</h2>
          <p class="text-lg text-graphite font-serif">{event.data.location}</p>
        </div>
      </div>
    </header>

    <div class="prose prose-lg max-w-none prose-p:leading-relaxed prose-headings:font-serif prose-headings:font-normal prose-headings:text-heritage-currant">
      <Content />

      <h2>Event Programme</h2>
      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut vel ante sed felis faucibus gravida. Nunc molestie ante ut metus. In hac habitasse platea dictumst. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Vivamus nec ipsum sed metus porta malesuada.
      </p>
      <p>
        Suspendisse feugiat. Donec porta diam eu massa. Quisque diam lorem, interdum vitae, tincidunt ac, venenatis quis, ante. Aliquam erat volutpat. Maecenas porttitor congue massa. Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna.
      </p>
    </div>
  </div>
</Layout>
